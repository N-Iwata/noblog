---
title: ã€GatsbyJSã€‘ãƒ–ãƒ­ã‚°ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸ
date: "2020-05-04"
description: ä»Šå›ã¯GatsbyJSãƒ–ãƒ­ã‚°ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¦ã€ã‚¿ã‚°ã”ã¨ã«è¨˜äº‹ä¸€è¦§ãŒè¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
slug: 2020-05-04/gatsby-tag
tags: [GatsbyJS, gatsby-starter-blog]
hero: ./hero.png
---

## ã¯ã˜ã‚ã«

ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ã“ã‚“ã«ã¡ã¯ï¼ã“ã‚“ã°ã‚“ã¯ï¼<br>
**ã®ãµã®ãµ**([@rpf_nob](https://twitter.com/rpf_nob))ã¨ç”³ã—ã¾ã™ï¼ï¼éƒ½å†…ã®ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦åƒã„ã¦ã„ã¾ã™ã€‚

ä»Šå›ã¯ GatsbyJS ãƒ–ãƒ­ã‚°ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¦ã€ã‚¿ã‚°ã”ã¨ã«è¨˜äº‹ä¸€è¦§ãŒè¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚<br>
åŸºæœ¬çš„ã«ã¯[å…¬å¼ãƒšãƒ¼ã‚¸](https://www.gatsbyjs.org/docs/adding-tags-and-categories-to-blog-posts/)ã®å†…å®¹é€šã‚Šã‚„ã‚Œã°ã§ãã¾ã™ã€‚

<div class="iframely-embed"><div class="iframely-responsive" style="height: 140px; padding-bottom: 0;"><a href="https://www.gatsbyjs.org/docs/adding-tags-and-categories-to-blog-posts/" data-iframely-url="//cdn.iframe.ly/IVg9xer"></a></div></div>

## å‰æ

ã“ã®ãƒ–ãƒ­ã‚°ã¯ GatsbyJS ã®[gatsby-starter-blog](https://www.gatsbyjs.org/starters/gatsbyjs/gatsby-starter-blog/)ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ä½œæˆã—ã¦ã„ã¾ã™ã€‚

<div class="iframely-embed"><div class="iframely-responsive" style="height: 140px; padding-bottom: 0;"><a href="https://www.gatsbyjs.org/starters/gatsbyjs/gatsby-starter-blog/" data-iframely-url="//cdn.iframe.ly/qjUJkBu?iframe=card-small"></a></div></div>

<br/>

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ï¼ˆå‚è€ƒã«ãªã£ãŸã¨ã„ã†æ–¹ã¯ â­ï¸ ã‚’ãƒãƒãƒƒã¨æŠ¼ã—ã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€œ ğŸ™‡â€â™‚ï¸ï¼‰

<div class="iframely-embed"><div class="iframely-responsive" style="height: 140px; padding-bottom: 0;"><a href="https://github.com/N-Iwata/noblog" data-iframely-url="//cdn.iframe.ly/Q4tAo8y?card=small"></a></div></div>

## è¨˜äº‹ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¿ã‚°ã‚’è¿½åŠ ã™ã‚‹

å„è¨˜äº‹ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šéƒ¨ã®ãƒ¡ã‚¿æƒ…å ±ã®éƒ¨åˆ†ã«[tags]ã‚’è¿½åŠ ã—ã¾ã™ã€‚è¤‡æ•°ã‚ã‚‹å ´åˆã¯[,]ã§é€£çµã—ã¦è¨˜è¼‰ã—ã¾ã™ã€‚

```html{6}
---
title: GatsbyJSãƒ–ãƒ­ã‚°ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ãŸ
date: "2020-05-04"
description: ä»Šå›ã¯GatsbyJSãƒ–ãƒ­ã‚°ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¦ã€ã‚¿ã‚°ã”ã¨ã«è¨˜äº‹ä¸€è¦§ãŒè¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
slug: 2020-05-04/gatsby-tag
tags: [GatsbyJS]
---
```

## GraphQL ã®ã‚¯ã‚¨ãƒªã‚’è¨˜è¿°ã—ã¦æŠ•ç¨¿è¨˜äº‹ã®ã‚¿ã‚°ã‚’å…¨ã¦å–å¾—ã™ã‚‹

[GraphiQL(http://localhost:8000/\_\_\_graphql)](http://localhost:8000/___graphql)ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ¬¡ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚Œã°ã€
ä¸‹ã®ã‚ˆã†ãªçµæœãŒè¿”ã£ã¦ãã‚‹ã¯ãšã§ã™ã€‚æŠ•ç¨¿è¨˜äº‹ã‚’[tags]ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¦ã€å„ tag ã®æŠ•ç¨¿æ•°ãŒ[totalCount]ã¨ã—ã¦è¿”ã£ã¦ãã¾ã™ã€‚

```GraphQL:title=GraphiQL
{
  allMarkdownRemark {
    group(field: frontmatter___tags) {
      tag: fieldValue
      totalCount
    }
  }
}
```

```
{
  "data": {
    "allMarkdownRemark": {
      "group": [
        {
          "tag": "GatsbyJS",
          "totalCount": 5
        },
        {
          "tag": "Netlify",
          "totalCount": 1
        },
        {
          "tag": "ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢",
          "totalCount": 1
        },
        {
          "tag": "ã‚³ãƒ­ãƒŠ",
          "totalCount": 1
        },
        {
          "tag": "ãƒ†ãƒ¬ãƒ¯ãƒ¼ã‚¯",
          "totalCount": 1
        },
        {
          "tag": "è‚¥æ–™",
          "totalCount": 1
        },
        {
          "tag": "èŠç”Ÿ",
          "totalCount": 1
        }
      ]
    }
  }
}
```

## ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹

[src/templates/tagpage/index.js]ã‚’æ–°è¦ä½œæˆã—ã€ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚<br>
åŸºæœ¬çš„ã«ã¯ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¨åŒã˜ã‚ˆã†ãªè¦‹ãŸç›®ã«ã—ãŸã„ã®ã§ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚ã»ã¨ã‚“ã©åŒã˜ã«ãªã‚Šã¾ã™ã€‚<br>
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–ã—ã¦å…±é€šåŒ–ã—ãŸã„ã§ã™ã­ãƒ»ãƒ»ãƒ»

```js:title=src/templates/tagpage.index.jsx
import React from "react";

import Bio from "../components/bio";
import Layout from "../components/layout";
import SEO from "../components/seo";
import { rhythm } from "../utils/typography";

// Components
import { Link, graphql } from "gatsby";

const Tags = ({ pageContext, data, location }) => {
  const { tag } = pageContext;
  const { edges, totalCount } = data.allMarkdownRemark;
  const author = data.site.siteMetadata.author.name;

  const tagHeader = `[${tag}]ã‚¿ã‚°ã®è¨˜äº‹ä¸€è¦§ï¼ˆå…¨${totalCount}ä»¶ï¼‰`;

  return (
    <div>
      <Layout location={location} author={author}>
        <SEO title={`Tag: ${tag}`} description={`${tag}ã‚¿ã‚°ã‚’å«ã‚€è¨˜äº‹ã®ä¸€è¦§ãƒšãƒ¼ã‚¸ã§ã™`} />
        <Bio />
        <h2>{tagHeader}</h2>
        {edges.map(({ node }) => {
          const title = node.frontmatter.title || node.fields.slug;
          return (
            <article key={node.fields.slug}>
              <header>
                <h3
                  style={{
                    marginBottom: rhythm(1 / 4),
                  }}
                >
                  <Link style={{ boxShadow: `none` }} to={node.frontmatter.slug}>
                    {title}
                  </Link>
                </h3>
                <small>{node.frontmatter.date}</small>
              </header>
              <section>
                <p
                  dangerouslySetInnerHTML={{
                    __html: node.frontmatter.description || node.excerpt,
                  }}
                />
              </section>
            </article>
          );
        })}
      </Layout>
    </div>
  );
};

export default Tags;

export const pageQuery = graphql`
  query($tag: String) {
    site {
      siteMetadata {
        title
        author {
          name
        }
      }
    }
    allMarkdownRemark(
      limit: 2000
      sort: { fields: [frontmatter___date], order: DESC }
      filter: { frontmatter: { tags: { in: [$tag] } } }
    ) {
      totalCount
      edges {
        node {
          fields {
            slug
          }
          frontmatter {
            title
            date(formatString: "YYYY-MM-DD")
            description
            slug
          }
        }
      }
    }
  }
`;
```

## ãƒšãƒ¼ã‚¸ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹

[gatsby-node.js]ã« â†‘ ã§ä½œæˆã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ãƒšãƒ¼ã‚¸ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚<br>
ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã™ã‚Œã°ã€[/tags/ã‚¿ã‚°å]ã«å„ã‚¿ã‚°ã®è¨˜äº‹ä¸€è¦§ãƒšãƒ¼ã‚¸ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

```js{8,10,56-67}:title=gatsby-node.js
const path = require(`path`);
const _ = require("lodash");

exports.createPages = async ({ graphql, actions }) => {
  const { createPage } = actions;

  const tagTemplate = path.resolve(`./src/templates/tagpage/index.jsx`);

  const result = await graphql(
    `
      {
        posts: allMarkdownRemark(sort: { fields: [frontmatter___date], order: DESC }, limit: 1000) {
          edges {
            node {
              fields {
                slug
              }
              frontmatter {
                title
                slug
              }
            }
          }
        }
        tags: allMarkdownRemark(limit: 1000) {
          group(field: frontmatter___tags) {
            fieldValue
          }
        }
      }
    `
  );
  if (result.errors) {
    throw result.errors;
  }
  const tags = result.data.tags.group;

  tags.forEach(tag => {
    createPage({
      path: `/tags/${_.kebabCase(tag.fieldValue)}/`,
      component: tagTemplate,
      context: {
        tag: tag.fieldValue,
      },
    });
  });
};
```

ã“ã‚Œã§ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚°ãƒšãƒ¼ã‚¸ãŒä½œæˆã•ã‚Œã¾ã™ã€‚
![img1.png](img1.png)

## è¨˜äº‹ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚¸ãƒ£ãƒ³ãƒ—ç”¨ã®ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹

æœ€å¾Œã«è¨˜äº‹ãƒšãƒ¼ã‚¸ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã¸ã®ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ãŸã‚ã®ã‚¿ã‚°ã‚’ã¤ã‘ã¦ã„ãã¾ã™ã€‚

### ã‚¿ã‚°è¡¨ç¤ºç”¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹

props ã§è¨˜äº‹ã®ã‚¿ã‚°ã®ãƒªã‚¹ãƒˆã‚’æ¸¡ã—ã¦ã‚‚ã‚‰ã„ã€ãã‚Œã‚’ä½¿ã£ã¦ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã«ã‚¸ãƒ£ãƒ³ãƒ—ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```js:title=src/components/tag/index.jsx
import React from "react";
import { Link } from "gatsby";
import _ from "lodash";

const Tag = props => {
  return (
    <div className="tag">
      {props.tags.map((tag, index) => {
        return (
          <Link to={`/tags/${_.kebabCase(tag)}/`} key={index} className="tag__list">
            {tag}
          </Link>
        );
      })}
    </div>
  );
};

export default Tag;
```

### ä½œæˆã—ãŸã‚¿ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç›®æ¬¡ã®å‰ã«æŒ¿å…¥

[src/templates/blogpost/index.jsx]ã®ç›®æ¬¡ã®å‰ã«ä¸Šã§ä½œã£ãŸ Tag ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æŒ¿å…¥ã—ã¾ã™ã€‚<br>
GraphQL ã§å–å¾—ã—ãŸ data.frontmatter.tags ã‚’ props ã¨ã—ã¦æ¸¡ã—ã¾ã™ã€‚

```js:title=src/templates/blogpost/index.jsx
<header>
ãƒ»ãƒ»ãƒ»çœç•¥
</header>
<Tag tags={post.frontmatter.tags} />
<Toc data={data.markdownRemark.tableOfContents} />
<section/>
```

### ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´

ã‚ã¨ã¯å¥½ããªã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä»˜ã‘ã¦å®Œæˆã¨ãªã‚Šã¾ã™ã€‚<br>

```scss
.tag {
  margin-bottom: 20px;

  &__list {
    margin-right: 10px;
    box-shadow: none;
    border: 1px solid #555;
    padding: 0 5px;
    border-radius: 3px;
    color: blue;
    background-color: #f2f2f2;
  }
}
```

![img2.png](img2.png)

## ã¾ã¨ã‚

ä»Šå›ã¯ GatsbyJS ãƒ–ãƒ­ã‚°ã«ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¦ã€ã‚¿ã‚°ã”ã¨ã«è¨˜äº‹ä¸€è¦§ãŒè¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚<br>
è¨˜äº‹ãŒå¢—ãˆã¦ããŸã¨ãã«ã€ã‚¿ã‚°ãƒšãƒ¼ã‚¸ãŒã‚ã‚‹ã¨èª­ã¿ãŸã„ã‚¿ã‚°ã‚’ä¸€æ°—ã«è¦‹ã‚Œã‚‹ã®ã§ã„ã„ã§ã™ã‚ˆã­ã€‚

ä»–ã«ã‚‚ GatsbyJS ã®ãƒ–ãƒ­ã‚°ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚’ã„ã‚ã„ã‚ã‚„ã£ã¦ã„ã‚‹ã®ã§ã€ä»¥ä¸‹ã‚‚ã‚ã‚ã›ã¦ã”è¦§ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

<div class="iframely-embed"><div class="iframely-responsive" style="height: 140px; padding-bottom: 0;"><a href="https://rpf-noblog.com/tags/gatsby-js/" data-iframely-url="//cdn.iframe.ly/5j7eIPT"></a></div></div>

<br>
<br>

æœ€å¾Œã¾ã§è¦‹ã¦ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ï¼
